# App Flow Document

## Onboarding and Sign-In/Sign-Up

When anyone first navigates to the Permisoria web application, they arrive at a sleek, dark-themed landing page that invites them to explore or sign in. At the top of this page, a “Public Permits” link directs visitors to a read-only view where they can search by permit number or business name and see basic details such as business name, permit type, issuing authority, issue date, expiration date, and status. No personal data or internal notes are exposed in this public view. From the landing page, prospective users choose to register or sign in. To register, a new user enters a valid email, creates a strong password, and selects their role as either Permit Manager or Business Owner. Upon submission, the system sends a verification email via SendGrid. The user must click the link in that email to confirm their address before accessing any features. Once verified, or if they are an existing user, they sign in by entering their email and password. If they forget their password, they click “Forgot Password,” receive a reset link from SendGrid, and follow that link to set a new password before returning to the sign-in page. After a successful sign in, users land on their role-specific homepage. At any time, users can sign out by opening the avatar menu in the global header and clicking “Sign Out,” which ends the session and returns them to the sign-in screen. Permit Managers and Business Owners may optionally enable time-based one-time password (TOTP) multi-factor authentication; for Admin and System Admin roles, MFA enrollment is required before these users can access sensitive areas of the application.

## Main Dashboard or Home Page

After logging in, Permit Managers are greeted by a dashboard with large metric cards showing the total number of businesses under management, the count of pending owner and business verifications, and the number of permits expiring soon within the default 30-day threshold. Below these summary cards, a live activity feed streams recent actions such as new verifications or permit additions. A vertical sidebar on the left lists links to Business Owners, Businesses, Permits, Subscriptions, Notifications, and Settings. The global header stretches across the top, displaying the Permisoria logo on the left, a search field for quick lookups by owner or permit, a notification bell that opens an in-app alert panel, and the user avatar on the right which reveals profile options. Business Owners see a simplified version of this dashboard featuring only their active permits, upcoming renewal reminders, and verification progress. Administrators and System Admins view a high-level dashboard with charts of user growth, system health indicators, and backlogs of pending verifications. From any dashboard, clicking a metric card or a sidebar link takes the user directly to the corresponding list or detail page.

## Detailed Feature Flows and Page Transitions

In the Business Owners section, Permit Managers arrive at a paginated list of owner profiles showing names, contact information, location badges, and status indicators such as Unverified, Pending, Verified, or Rejected. To add a new owner, they click an “Add Business Owner” button, which opens a modal requesting first name, last name, email, and phone. Submitting the form immediately creates the record and routes the user to the owner’s detail page. That page presents tabs for Overview, Associated Businesses, Documents, History, and Notes. In the Documents tab, clicking “Upload Document” opens a file selector that accepts PDF, JPG, and PNG formats up to 5 MB for Free tier users or up to 50 MB for Business tier. Uploaded files appear as thumbnails in a grid. When the manager clicks “Start Verification,” a multi-step wizard guides them through reviewing each document side by side with a dynamic checklist. Approvals and comments update the owner’s status badge in real time and are logged in the History tab.

The Businesses flow is similar. From the sidebar, users select “Businesses” to see a list of entities showing legal name, DBA, linked owners count, address, and verification status. Choosing “Add Business” opens a modal that requires a verified owner, business name, type, and tax ID. Saving the form navigates to the Business detail page with tabs for Overview, Permits, Owners, Documents, Notes, and History. The Overview tab displays legal and contact details alongside a dark-themed Google Map showing the geocoded address. The Owners tab lists linked owners and offers a searchable modal to link additional verified owners. The Documents tab allows uploading and previewing business documents with the same split-pane wizard for verification.

Within each Business detail page, the “Permits” tab lists existing permits with columns for permit name, number, issuing authority, issue and expiration dates, and a color-coded status badge that automatically determines whether a permit is Active, Expiring Soon, Expired, or Unknown. Clicking “Add Permit Record” launches a modal where the user enters permit details, attaches scanned documents, and adds optional notes. Upon saving, the system recalculates the status, displays the updated badge, and may trigger a notification if the expiration date falls within the 30-day window. Users can edit or delete permits from the same tab; any change logs an entry in the History tab for auditability.

Document management is unified across Owners, Businesses, and Permits. Wherever an upload button appears, the file selector enforces the allowed file types and size limits. Uploaded documents show in a contextual grid, and clicking a document opens a split-pane review modal that displays the file alongside verification checklists. Verifiers add comments, approve or reject, and see the result applied instantly to the associated record.

Permit Managers handle subscription and billing under the “Subscriptions” link in the sidebar. They view their current tier, usage metrics compared against free-tier limits (three businesses, three owners, five permits each), and the remaining days of any 14-day trial. If they approach or exceed a limit, an in-app banner suggests an upgrade. Clicking “Upgrade” routes to Stripe Checkout for secure payment and subscription setup. After a successful transaction, the user returns to Permisoria with immediate access to Business-tier features. From the same page, users can cancel or downgrade their subscription; cancellations take effect at the end of the current billing cycle while full access remains until that date. Stripe webhooks notify the application of subscription events, and the backend updates the user’s subscription status accordingly.

Notifications flow through the bell icon in the header. In-app alerts are delivered via Supabase Realtime, and email notifications are sent through SendGrid. Events such as permit expiration thresholds, verification results, and subscription changes trigger notifications according to each user’s preferences. Clicking a notification directs the user to the exact Owner, Business, or Permit detail page related to the alert.

## Settings and Account Management

Clicking the avatar in the global header opens the Settings page. In their personal profile, users update name, email, phone, and address information. They may change their password by entering the current password and then choosing a new one. Permit Managers and Admin roles can enable two-factor authentication by scanning a QR code in a TOTP app. Business Owners see a pared-down settings view that includes only profile fields and notification preferences. Permit Managers also manage notification settings here, choosing which events send in-app alerts, emails, or both. Subscription details are accessible on a separate tab within Settings for viewing payment history or accessing the Stripe Customer Portal. After saving any changes, a confirmation toast appears, and users return to their previous location without losing context.

## Error States and Alternate Paths

If a user enters invalid data—such as a malformed email, missing required field, or a file that exceeds the allowed size—a clear inline validation message appears next to the offending field. When network connectivity is lost, the application displays a persistent banner warning that API-dependent actions are disabled until the connection is restored. Any attempt to perform restricted actions—such as linking an unverified owner, exceeding free-tier limits, or accessing Admin-only pages—opens a modal that explains the issue and offers a solution or a link to upgrade or complete verification. In the event of server errors or unhandled exceptions, the user sees a generic error page with a brief apology, a retry button, and an option to report the problem for investigation.

## Conclusion and Overall App Journey

From the very first visit on the public landing page to everyday permit tracking, Permisoria guides users through a clear, uninterrupted workflow. Visitors may browse public permit information before signing up. New users register with email and password, verify by clicking a SendGrid email link, and log in to a role-specific dashboard. Permit Managers add and verify Business Owners, create and verify Businesses, and manage Permits with automated status tracking. Documents are uploaded, reviewed, and approved within split-pane modals. Notifications remind users of expiring permits or subscription events. Settings allow full control over personal information, security, and notification preferences. Stripe integration handles subscription upgrades and trials, while Supabase powers authentication, real-time alerts, and secure document storage. Throughout the journey, a consistent dark theme, responsive design, smooth transitions, and accessible interactions ensure every user can focus on compliance rather than paperwork, confident that no expiration or renewal will ever slip through the cracks.
